<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>闲客&#39;Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="闲客&#39;Blog">
<meta property="og:url" content="http://xianke5200.github.io/index.html">
<meta property="og:site_name" content="闲客&#39;Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="xianke5200">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="闲客&#39;Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
      
<link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
<meta name="generator" content="Hexo 5.2.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<!--人体时钟背景透明-->
	<script charset="Shift_JIS" src="http://chabudai.sakura.ne.jp/blogparts/honehoneclock/honehone_clock_tr.js"></script>

    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/head.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate"></a></h1>
        </hgroup>

        
        <div id="binft"></div>
			<script>
				var binft = function (r) {
				    function t() {
						return b[Math.floor(Math.random() * b.length)]
				    }  
				    function e() {
						return String.fromCharCode(94 * Math.random() + 33)
				    }
				    function n(r) {
						for (var n = document.createDocumentFragment(), i = 0; r > i; i++) {
						    var l = document.createElement("span");
						    l.textContent = e(), l.style.color = t(), n.appendChild(l)
					    }
					    return n
				    }
				    function i() {
						var t = o[c.skillI];
						c.step ? c.step-- : (c.step = g, c.prefixP < l.length ? (c.prefixP >= 0 && (c.text += l[c.prefixP]), c.prefixP++) : "forward" === c.direction ? c.skillP < t.length ? (c.text += t[c.skillP], c.skillP++) : c.delay ? c.delay-- : (c.direction = "backward", c.delay = a) : c.skillP > 0 ? (c.text = c.text.slice(0, -1), c.skillP--) : (c.skillI = (c.skillI + 1) % o.length, c.direction = "forward")), r.textContent = c.text, r.appendChild(n(c.prefixP < l.length ? Math.min(s, s + c.prefixP) : Math.min(s, t.length - c.skillP))), setTimeout(i, d)
				    }
				    var l = "",
				    o = [theme.subtitle].map(function (r) {
				    return r + ""
				    }),
				    a = 2,
				    g = 1,
				    s = 5,
				    d = 75,
				    b = ["rgb(110,64,170)", "rgb(150,61,179)", "rgb(191,60,175)", "rgb(228,65,157)", "rgb(254,75,131)", "rgb(255,94,99)", "rgb(255,120,71)", "rgb(251,150,51)", "rgb(226,183,47)", "rgb(198,214,60)", "rgb(175,240,91)", "rgb(127,246,88)", "rgb(82,246,103)", "rgb(48,239,130)", "rgb(29,223,163)", "rgb(26,199,194)", "rgb(35,171,216)", "rgb(54,140,225)", "rgb(76,110,219)", "rgb(96,84,200)"],
				    c = {
						text: "",
						prefixP: -s,
						skillI: 0,
						skillP: 0,
						direction: "forward",
						delay: a,
						step: g
				    };
				    i()
				};
				binft(document.getElementById('binft'));
			</script>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="search" placeholder=" Search...">
            </form>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">博客首页</a></li>
                        
                            <li><a href="/categories">文章分类</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github" target="_blank" href="https://github.com/xianke5200" title="github">github</a>
                            
                                <a class="fl rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/test/" style="font-size: 10px;">test</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://xianke5200.github.io/">xianke5200</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">个人博客记录</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/head.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me"></a></h1>
            </hgroup>
            
            <p class="header-subtitle">业精于勤荒于嬉， 行成于思毁于随</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">博客首页</a></li>
                
                    <li><a href="/categories">文章分类</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="https://github.com/xianke5200" title="github">github</a>
                    
                        <a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/14/hello-world/" class="article-date">
      <time datetime="2020-10-14T12:25:26.136Z" itemprop="datePublished">2020-10-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/14/hello-world/">Hello World</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              Welcome to [Hexo]
          
      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/test/">test</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/test/" rel="tag">test</a></li></ul>
    </div>

      
        <p class="article-more-link">
          <a  href="/2020/10/14/hello-world/#more">阅读全文 >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Python用PIL获取图片信息" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/08/11/Python%E7%94%A8PIL%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E4%BF%A1%E6%81%AF/" class="article-date">
      <time datetime="2020-08-11T08:04:37.000Z" itemprop="datePublished">2020-08-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/08/11/Python%E7%94%A8PIL%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E4%BF%A1%E6%81%AF/">Python用PIL获取图片信息</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>我们利用处理PNG图片是，可能需要获取基本的图片信息来做一些基本的处理，话不多说，上代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">img = Image.open(<span class="string">&quot;more.png&quot;</span>)</span><br><span class="line"><span class="comment"># img.show()</span></span><br><span class="line"></span><br><span class="line">print(img.size)<span class="comment">#获取图片大小（width， height）</span></span><br><span class="line">print(img.size[<span class="number">0</span>], img.size[<span class="number">1</span>]) <span class="comment">#（width， height）</span></span><br><span class="line">print(img.mode)<span class="comment">#获取图片模式&#123;&#x27;1&#x27;:1, &#x27;L&#x27;:8, &#x27;P&#x27;:8(带颜色表), &#x27;RGB&#x27;:24, &#x27;RGBA&#x27;:32,&#125;</span></span><br><span class="line">print(img.info) <span class="comment">#打印的信息类似下方注释，当然必须图片内部包含该信息才行</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">&#x27;Software&#x27;: &#x27;Adobe ImageReady&#x27;, </span></span><br><span class="line"><span class="string">&#x27;XML:com.adobe.xmp&#x27;: &#x27;&lt;?xpacket begin=&quot;\ufeff&quot; id=&quot;W5M0MpCehiHzreSzNTczkc9d&quot;?&gt; </span></span><br><span class="line"><span class="string">&lt;x:xmpmeta </span></span><br><span class="line"><span class="string"> xmlns:x=&quot;adobe:ns:meta/&quot; </span></span><br><span class="line"><span class="string"> x:xmptk=&quot;Adobe XMP Core 5.6-c140 79.160451, 2017/05/06-01:08:21        &quot;&gt; </span></span><br><span class="line"><span class="string">&lt;rdf:RDF xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;&gt;</span></span><br><span class="line"><span class="string"> &lt;rdf:Description rdf:about=&quot;&quot; xmlns:xmp=&quot;http://ns.adobe.com/xap/1.0/&quot; </span></span><br><span class="line"><span class="string"> xmlns:xmpMM=&quot;http://ns.adobe.com/xap/1.0/mm/&quot; </span></span><br><span class="line"><span class="string"> xmlns:stRef=&quot;http://ns.adobe.com/xap/1.0/sType/ResourceRef#&quot; </span></span><br><span class="line"><span class="string"> xmp:CreatorTool=&quot;Adobe Photoshop CC 2018 (Macintosh)&quot; xmpMM:InstanceID=&quot;xmp.iid:AE0F209DE45311E998F5EA8083EEF15A&quot; </span></span><br><span class="line"><span class="string"> xmpMM:DocumentID=&quot;xmp.did:AE0F209EE45311E998F5EA8083EEF15A&quot;&gt; </span></span><br><span class="line"><span class="string"> &lt;xmpMM:DerivedFrom stRef:instanceID=&quot;xmp.iid:AE0F209BE45311E998F5EA8083EEF15A&quot; </span></span><br><span class="line"><span class="string"> stRef:documentID=&quot;xmp.did:AE0F209CE45311E998F5EA8083EEF15A&quot;/&gt; </span></span><br><span class="line"><span class="string"> &lt;/rdf:Description&gt; &lt;/rdf:RDF&gt; &lt;/x:xmpmeta&gt; &lt;?xpacket end=&quot;r&quot;?&gt;&#x27;</span></span><br><span class="line"><span class="string"> &#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">sequ = img.getdata()</span><br><span class="line">sequ0 = list(sequ)</span><br><span class="line">print(sequ0)<span class="comment">#获取图片像素值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> img.mode == <span class="string">&#x27;P&#x27;</span>:</span><br><span class="line">    print(img.palette.palette)<span class="comment">#打印颜色表</span></span><br><span class="line">    <span class="comment"># lut = img.resize((99, 99))</span></span><br><span class="line">    <span class="comment"># lut.putdata(range(256))</span></span><br><span class="line">    lut = lut.convert(<span class="string">&quot;RGB&quot;</span>)<span class="comment">#将图片转换为RGB图像</span></span><br><span class="line">    print(list(lut.getdata()))<span class="comment">#打印图像RGB像素值</span></span><br><span class="line">    <span class="comment"># pix = lut.load()</span></span><br><span class="line">    <span class="comment"># print(pix[1, 0])</span></span><br><span class="line">    <span class="comment"># lut.show()</span></span><br><span class="line">    <span class="comment"># lut now contains a sequence of (r, g, b) tuples</span></span><br><span class="line"></span><br><span class="line">pix = img.load()</span><br><span class="line">print(pix[img.size[<span class="number">0</span>]/<span class="number">2</span>, img.size[<span class="number">1</span>]/<span class="number">2</span>])<span class="comment">#某个点（x, y）的像素值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> img.mode == <span class="string">&#x27;RGBA&#x27;</span>:</span><br><span class="line">	r,g,b, a = img.split()</span><br><span class="line">	print(r.mode)</span><br><span class="line">	print(r.size)</span><br><span class="line">	print(img.size)</span><br></pre></td></tr></table></figure>


      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/GUI/">GUI</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Python爬取哔哩哔哩视频的相关信息后续" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/08/03/Python%E7%88%AC%E5%8F%96%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9%E8%A7%86%E9%A2%91%E7%9A%84%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E5%90%8E%E7%BB%AD/" class="article-date">
      <time datetime="2020-08-03T11:50:28.000Z" itemprop="datePublished">2020-08-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/08/03/Python%E7%88%AC%E5%8F%96%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9%E8%A7%86%E9%A2%91%E7%9A%84%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E5%90%8E%E7%BB%AD/">Python爬取哔哩哔哩视频的相关信息后续</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>上一篇文章通过selenium工具自动搜索爬取哔哩哔哩上面的视频相关信息，今天我们接着上一篇文章，保存视频的图片到本地。<br>首先找到要爬取的网页数据所在的位置，如下图<br><img src="https://img-blog.csdnimg.cn/20200803192657446.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzMzMzIzNTQ0,size_16,color_FFFFFF,t_70" alt="爬取的图片标签信息以及网址"><br>并且，右键点击该网址，可以选择在新标签页中打开，在新标签页中，除了显示图片不会显示其他东西。如下<img src="https://img-blog.csdnimg.cn/20200803193319709.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzMzMzIzNTQ0,size_16,color_FFFFFF,t_70" alt="图片数据"><br>到这就是原本的图片数据了，如果跳转过后依然不是这样，就需要继续往下寻找到最终的图片数据地址。<br>在上一篇文章的基础上就添加了一个保存图片的函数，上代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">img_save</span>(<span class="params">soup</span>):</span></span><br><span class="line">    img_url_list = soup.find(class_=<span class="string">&#x27;video-list clearfix&#x27;</span>).find_all_next(class_=<span class="string">&#x27;img-anchor&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20200803194021234.png" alt="在这里插入图片描述"><br>查找包含图片连接的标签，得到如上所示片段</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">index = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> url <span class="keyword">in</span> img_url_list:</span><br><span class="line">      img_url = url.find(<span class="string">&#x27;img&#x27;</span>).get(<span class="string">&#x27;src&#x27;</span>)</span><br><span class="line">      print(img_url)</span><br></pre></td></tr></table></figure>
<pre><code>//i2.hdslb.com/bfs/archive/176fdf5ba89c5eff3c0f300aaf53967dcddff923.jpg@320w_200h.webp</code></pre>
<p>获取图片链接地址，得到如上文本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> img_url != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">          img_request = (<span class="string">&#x27;https:&#x27;</span>+ img_url).replace(<span class="string">&#x27;webp&#x27;</span>, <span class="string">&#x27;jpg&#x27;</span>)</span><br><span class="line">          print(img_request)</span><br><span class="line">          img_resp = requests.get(img_request)</span><br></pre></td></tr></table></figure>
<pre><code>https://i2.hdslb.com/bfs/archive/176fdf5ba89c5eff3c0f300aaf53967dcddff923.jpg@320w_200h.jpg</code></pre>
<p>将得到的网址进行拼接，并替换最后的‘webp’为‘jpg’，如果不修改直接保存到本地，图片会无法正常显示</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&quot;cxk_video_img&quot;</span>):</span><br><span class="line">            os.mkdir(<span class="string">&#x27;cxk_video_img&#x27;</span>)</span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">&#x27;cxk_video_img/%d.jpg&#x27;</span> %index, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(img_resp.content)</span><br><span class="line">    index += <span class="number">1</span></span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>最后就是新建文件夹，保存图片到文件夹中。<br>但是有一个问题，就是有的图片网址获取到的为空，不知道是否和网速也有关系，还是代码本身部分还有我没有发现的欠缺，欢迎各位大佬指正。<br>完整代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> TimeoutException</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">browser = webdriver.Chrome()</span><br><span class="line"><span class="comment">#browser = webdriver.PhantomJS()</span></span><br><span class="line">WAIT = WebDriverWait(browser, <span class="number">20</span>)</span><br><span class="line">browser.set_window_size(<span class="number">1400</span>, <span class="number">900</span>)</span><br><span class="line"></span><br><span class="line">book = xlwt.Workbook(encoding=<span class="string">&#x27;utf-8&#x27;</span>, style_compression=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">sheet = book.add_sheet(<span class="string">&#x27;蔡徐坤篮球&#x27;</span>, cell_overwrite_ok=<span class="literal">True</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;名称&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">1</span>, <span class="string">&#x27;地址&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">2</span>, <span class="string">&#x27;描述&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">3</span>, <span class="string">&#x27;观看次数&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">4</span>, <span class="string">&#x27;弹幕数&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">5</span>, <span class="string">&#x27;发布时间&#x27;</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        print(<span class="string">&#x27;开始访问b站....&#x27;</span>)</span><br><span class="line">        browser.get(<span class="string">&quot;https://www.bilibili.com/&quot;</span>)</span><br><span class="line"></span><br><span class="line">        search = browser.find_element_by_xpath(<span class="string">&#x27;//div[@class=&quot;nav-search&quot;]/form/input&#x27;</span>)</span><br><span class="line">        search.send_keys(<span class="string">&quot;蔡徐坤 篮球&quot;</span>)</span><br><span class="line">        search.send_keys(Keys.ENTER)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 跳转到新的窗口</span></span><br><span class="line">        print(<span class="string">&#x27;跳转到新窗口&#x27;</span>)</span><br><span class="line">        all_h = browser.window_handles</span><br><span class="line">        browser.switch_to.window(all_h[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># html = browser.page_source</span></span><br><span class="line">        <span class="comment"># # print(html)</span></span><br><span class="line">        <span class="comment"># soup = BeautifulSoup(html, &#x27;html.parser&#x27;)</span></span><br><span class="line">        <span class="comment"># save_to_excel(soup)</span></span><br><span class="line">        <span class="comment"># total_index = soup.find(class_=&#x27;page-item last&#x27;).find(class_=&#x27;pagination-btn&#x27;)</span></span><br><span class="line"></span><br><span class="line">        get_source()</span><br><span class="line">        total_index = WAIT.until(EC.presence_of_element_located((By.CSS_SELECTOR,</span><br><span class="line">                                                                 <span class="string">&quot;li.page-item.last &gt; button&quot;</span>)))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># pattern = re.compile(&#x27;&lt;div class=&quot;page-wrap&quot;&gt;.*?&lt;li class=&quot;page-item last&quot;&gt;.*?(\d+).*?&lt;/div&gt;&#x27;, re.S)</span></span><br><span class="line">        <span class="comment"># total_index = int(re.findall(pattern, html)[0])</span></span><br><span class="line">        <span class="keyword">return</span> int(total_index.text)</span><br><span class="line">    <span class="keyword">except</span> TimeoutException:</span><br><span class="line">        <span class="keyword">return</span> search()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next_page</span>(<span class="params">page_num</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        print(<span class="string">&#x27;获取第(%d)页数据&#x27;</span> % page_num)</span><br><span class="line">        next_btn = WAIT.until(EC.element_to_be_clickable((By.CSS_SELECTOR,</span><br><span class="line">                                                          <span class="string">&#x27;li.page-item.next &gt; button&#x27;</span>)))</span><br><span class="line">        next_btn.click()</span><br><span class="line">        get_source()</span><br><span class="line">    <span class="keyword">except</span> TimeoutException:</span><br><span class="line">        browser.refresh()</span><br><span class="line">        <span class="keyword">return</span> next_page(page_num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_to_excel</span>(<span class="params">soup</span>):</span></span><br><span class="line">    list = soup.find(class_=<span class="string">&#x27;video-list clearfix&#x27;</span>).find_all_next(class_=<span class="string">&#x27;info&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> list:</span><br><span class="line">        item_title = item.find(<span class="string">&#x27;a&#x27;</span>).get(<span class="string">&#x27;title&#x27;</span>)</span><br><span class="line">        item_link = item.find(<span class="string">&#x27;a&#x27;</span>).get(<span class="string">&#x27;href&#x27;</span>)</span><br><span class="line">        item_dec = item.find(class_=<span class="string">&#x27;des hide&#x27;</span>).text</span><br><span class="line">        item_view = item.find(class_=<span class="string">&#x27;so-icon watch-num&#x27;</span>).text</span><br><span class="line">        item_biubiu = item.find(class_=<span class="string">&#x27;so-icon hide&#x27;</span>).text</span><br><span class="line">        item_date = item.find(class_=<span class="string">&#x27;so-icon time&#x27;</span>).text</span><br><span class="line"></span><br><span class="line">        print(<span class="string">&#x27;爬取：&#x27;</span> + item_title)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">global</span> n</span><br><span class="line"></span><br><span class="line">        sheet.write(n, <span class="number">0</span>, item_title)</span><br><span class="line">        sheet.write(n, <span class="number">1</span>, item_link)</span><br><span class="line">        sheet.write(n, <span class="number">2</span>, item_dec)</span><br><span class="line">        sheet.write(n, <span class="number">3</span>, item_view)</span><br><span class="line">        sheet.write(n, <span class="number">4</span>, item_biubiu)</span><br><span class="line">        sheet.write(n, <span class="number">5</span>, item_date)</span><br><span class="line"></span><br><span class="line">        n = n + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">img_save</span>(<span class="params">soup</span>):</span></span><br><span class="line">    img_url_list = soup.find(class_=<span class="string">&#x27;video-list clearfix&#x27;</span>).find_all_next(class_=<span class="string">&#x27;img-anchor&#x27;</span>)</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> img_url_list:</span><br><span class="line">        img_url = url.find(<span class="string">&#x27;img&#x27;</span>).get(<span class="string">&#x27;src&#x27;</span>)</span><br><span class="line">        print(img_url)</span><br><span class="line">        <span class="keyword">if</span> img_url != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            img_request = (<span class="string">&#x27;https:&#x27;</span>+ img_url).replace(<span class="string">&#x27;webp&#x27;</span>, <span class="string">&#x27;jpg&#x27;</span>)</span><br><span class="line">            print(img_request)</span><br><span class="line">            img_resp = requests.get(img_request)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&quot;cxk_video_img&quot;</span>):</span><br><span class="line">                os.mkdir(<span class="string">&#x27;cxk_video_img&#x27;</span>)</span><br><span class="line">            <span class="keyword">with</span> open(<span class="string">&#x27;cxk_video_img/%d.jpg&#x27;</span> %index, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(img_resp.content)</span><br><span class="line">        index += <span class="number">1</span></span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_source</span>():</span></span><br><span class="line">    WAIT.until(EC.presence_of_element_located(</span><br><span class="line">        (By.CSS_SELECTOR, <span class="string">&#x27;ul.video-list.clearfix&#x27;</span>)))</span><br><span class="line">    <span class="comment"># browser.refresh()</span></span><br><span class="line">    html = browser.page_source</span><br><span class="line">    <span class="comment"># print(html)</span></span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">    save_to_excel(soup)</span><br><span class="line">    img_save(soup)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        total = search()</span><br><span class="line">        <span class="comment"># print(total)</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, int(total)+<span class="number">1</span>):</span><br><span class="line">            next_page(i)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        browser.close()</span><br><span class="line">        browser.quit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line">    book.save(<span class="string">u&#x27;蔡徐坤篮球.xls&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>本来还想爬取保存视频到本地，结果没法得到视频的最终地址，所以只能暂且搁置，保存视频到本地，也可以采用保存图片相类似的方式。</p>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/python3-%E7%88%AC%E8%99%AB/">python3 爬虫</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Python爬取哔哩哔哩视频的相关信息并保存到excel文档" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/08/01/Python%E7%88%AC%E5%8F%96%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9%E8%A7%86%E9%A2%91%E7%9A%84%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E5%B9%B6%E4%BF%9D%E5%AD%98%E5%88%B0excel%E6%96%87%E6%A1%A3/" class="article-date">
      <time datetime="2020-08-01T09:22:53.000Z" itemprop="datePublished">2020-08-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/08/01/Python%E7%88%AC%E5%8F%96%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9%E8%A7%86%E9%A2%91%E7%9A%84%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E5%B9%B6%E4%BF%9D%E5%AD%98%E5%88%B0excel%E6%96%87%E6%A1%A3/">Python爬取哔哩哔哩视频的相关信息并保存到excel文档</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>利用自动化测试工具selenium自动搜索视频信息，自动翻页爬取搜索到的视频相关信息。<br>首先找到自己要爬取数据网页数据，如下<br><img src="https://img-blog.csdnimg.cn/20200803192538130.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzMzMzIzNTQ0,size_16,color_FFFFFF,t_70" alt="爬取的网页数据"><br>整个流程如下：<br>    1.声明浏览器对象<br>    2.声明浏览器最长等待时间<br>    3.创建excel文件对象<br>    4.新建excel sheet页，并写入头部标签<br>    5.浏览器访问网页地址<br>    6.定位输入窗口，输入文字并回车跳转<br>    7.切换到新标签页<br>    8.等待网页数据加载完成<br>    9.beautifulSoup解析网页数据<br>    10.找到要爬取的数据，并保存到excel中<br>    11.获取搜索到的最大页数<br>    12.等待下一页按钮加载完成，并点击下一页按钮切换到下一页<br>    13.重复8-10步和12步，直到所有页数爬取完毕</p>
<ol>
<li><p>声明浏览器对象，并设置浏览器窗口大小</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">browser = webdriver.Chrome()</span><br><span class="line"><span class="comment">#browser = webdriver.PhantomJS()</span></span><br><span class="line">browser.set_window_size(<span class="number">1400</span>, <span class="number">900</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>创建excel文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">book = xlwt.Workbook(encoding=<span class="string">&#x27;utf-8&#x27;</span>, style_compression=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">sheet = book.add_sheet(<span class="string">&#x27;蔡徐坤篮球&#x27;</span>, cell_overwrite_ok=<span class="literal">True</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;名称&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">1</span>, <span class="string">&#x27;地址&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">2</span>, <span class="string">&#x27;描述&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">3</span>, <span class="string">&#x27;观看次数&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">4</span>, <span class="string">&#x27;弹幕数&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">5</span>, <span class="string">&#x27;发布时间&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>在这里采用xlwt库对excel文件进行写入操作，xlwt库只能写入数据，无法读取数据</p>
</li>
<li><p>访问B站，并自动搜索，同时返回视频页数</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        print(<span class="string">&#x27;开始访问b站....&#x27;</span>)</span><br><span class="line">        browser.get(<span class="string">&quot;https://www.bilibili.com/&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        search = browser.find_element_by_xpath(<span class="string">&#x27;//div[@class=&quot;nav-search&quot;]/form/input&#x27;</span>)</span><br><span class="line">        search.send_keys(<span class="string">&quot;蔡徐坤 篮球&quot;</span>)</span><br><span class="line">        search.send_keys(Keys.ENTER)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 跳转到新的窗口</span></span><br><span class="line">        print(<span class="string">&#x27;跳转到新窗口&#x27;</span>)</span><br><span class="line">        all_h = browser.window_handles</span><br><span class="line">        browser.switch_to.window(all_h[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        html = browser.page_source</span><br><span class="line">        <span class="comment"># print(html)</span></span><br><span class="line">        soup = BeautifulSoup(html, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">        save_to_excel(soup)</span><br><span class="line"></span><br><span class="line">        total_index = soup.find(class_=<span class="string">&#x27;page-item last&#x27;</span>).find(class_=<span class="string">&#x27;pagination-btn&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> int(total_index.text)</span><br><span class="line">    <span class="keyword">except</span> TimeoutException:</span><br><span class="line">        <span class="keyword">return</span> search()</span><br></pre></td></tr></table></figure>
<p>3.1 打开浏览器，访问B站</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser.get(<span class="string">&quot;https://www.bilibili.com/&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>3.2 定位搜索框的位置，并填入要搜索的文本，并回车</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">search = browser.find_element_by_xpath(<span class="string">&#x27;//div[@class=&quot;nav-search&quot;]/form/input&#x27;</span>)</span><br><span class="line">  search.send_keys(<span class="string">&quot;蔡徐坤 篮球&quot;</span>)</span><br><span class="line">  search.send_keys(Keys.ENTER)</span><br></pre></td></tr></table></figure>
<p>selenium可以驱动浏览器代替人工完成各种操作，查找定位要操作的节点，填充数据，模拟点击，拖拽等<br>查找单个节点可以通过如下方法：<br>find_element_by_id 【通过元素的 id 来选择】<br>例：<div id='bdy-inner'>test</div>，查找：driver.find_element_by_id(‘bdy-inner’)</p>
<p>find_element_by_name 【通过元素的 name 来选择】<br>例：<input name="username" type="text" />，查找：driver.find_element_by_name(‘password’)</p>
<p>find_element_by_xpath 【通过 xpath 选择】<br>例：<form id="loginForm">，查找：driver.find_element_by_xpath(“//form[@id=’loginForm’]”)</p>
<p>find_element_by_link_text 【通过链接地址选择】<br>例：<a href="continue.html">continue</a>，查询：driver.find_element_by_link_text(‘continue’)</p>
<p>find_element_by_partial_link_text 【通过链接的部分地址选择】<br>例：<a href="continue.html">continue</a>，查询：driver.find_element_by_link_text(‘cont’)</p>
<p>find_element_by_tag_name 【通过元素的名称选择】<br>例：&lt; h1&gt;welcome&lt; h1&gt;，查询：driver.find_element_by_tag_name(‘h1’)</p>
<p>find_element_by_class_name 【通过元素的 class 选择】<br>例：&lt; p class=”content”&gt;welcome to TRHX’S BLOG!&lt; /p&gt;，查询：driver.find_element_by_class_name(‘content’)</p>
<p>find_element_by_css_selector 【通过元素的 class 选择】<br>例：&lt; div class=’bdy-inner’&gt;test&lt; /div&gt;，查询：driver.find_element_by_css_selector(‘div.bdy-inner’)</p>
<p>find_element() 【通用方法，需要传递两个参数：查找方式 By 和值】<br>例：driver.find_element_by_id(‘inner’) 等价于 find_element(By.ID, inner)，使用时需要from selenium.webdriver.common.by import By</p>
<p>selenium对浏览器的操作也可称之为节点交互，常用的节点交互方式有以下几种<br>    send_keys：模拟按键输入<br>    clear：清除元素的内容<br>    click：单击元素<br>    submit：提交表单</p>
<p>3.3 完成点击操作后，搜索结果会在新标签页中呈现，这时需要切换到新标签页中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">&#x27;跳转到新窗口&#x27;</span>)</span><br><span class="line">   all_h = browser.window_handles</span><br><span class="line">   browser.switch_to.window(all_h[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<p>3.4 获取第一页的视频相关信息，并保存到excel文档中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">html = browser.page_source</span><br><span class="line"><span class="comment"># print(html)</span></span><br><span class="line">soup = BeautifulSoup(html, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">save_to_excel(soup)</span><br></pre></td></tr></table></figure>
<p>这里采用beautifulSoup库对网页数据进行解析。<br>常用的解析器有四种,如下：<br>| 解析器 | 使用方法 |<br>|–|–|<br>| Python 标准库 | BeautifulSoup(markup, “html.parser”)     |<br>|LXML HTML 解析器|BeautifulSoup(markup, “lxml”)|<br>|LXML XML 解析器|BeautifulSoup(markup, “xml”)|<br>|html5lib|BeautifulSoup(markup, “html5lib”)|<br>3.5 返回搜索结果的页数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">total_index = soup.find(class_=<span class="string">&#x27;page-item last&#x27;</span>).find(class_=<span class="string">&#x27;pagination-btn&#x27;</span>)</span><br><span class="line"><span class="keyword">return</span> int(total_index.text)</span><br></pre></td></tr></table></figure>
<p>这里利用beautifulSoup解析器提取名为page-item last的class节点下的pagination-btn节点文本数据，得到总的搜索页数<br>4. 点击下一页按钮，并爬取下一页视频信息保存</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">WAIT = WebDriverWait(browser, <span class="number">20</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next_page</span>(<span class="params">page_num</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        print(<span class="string">&#x27;获取第(%d)页数据&#x27;</span> % page_num)</span><br><span class="line">        next_btn = WAIT.until(EC.element_to_be_clickable((By.CSS_SELECTOR,</span><br><span class="line">                                                          <span class="string">&#x27;li.page-item.next &gt; button&#x27;</span>)))</span><br><span class="line">        next_btn.click()</span><br><span class="line">        get_source()</span><br><span class="line">    <span class="keyword">except</span> TimeoutException:</span><br><span class="line">        browser.refresh()</span><br><span class="line">        <span class="keyword">return</span> next_page(page_num)</span><br></pre></td></tr></table></figure>
<p>引入 WebDriverWait 对象，指定最长等待时间，这里最长等待时间20秒，调用它的 until() 方法，传入要等待条件 expected_conditions。比如，这里传入了 element_to_be_clickable这个条件，代表节点被选中，并可以被点击的时候<br>4.1 定位下一页按钮位置，并发送点击事件切换到下一页</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">&#x27;获取第(%d)页数据&#x27;</span> % page_num)</span><br><span class="line">       next_btn = WAIT.until(EC.element_to_be_clickable((By.CSS_SELECTOR,</span><br><span class="line">                                                         <span class="string">&#x27;li.page-item.next &gt; button&#x27;</span>)))</span><br><span class="line">       next_btn.click()</span><br></pre></td></tr></table></figure>
<p>4.2 切换到下一页后，等待ul.video-list.clearfix节点出现，再获取界面数据，爬取视频信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_source</span>():</span></span><br><span class="line">    WAIT.until(EC.presence_of_element_located(</span><br><span class="line">        (By.CSS_SELECTOR, <span class="string">&#x27;ul.video-list.clearfix&#x27;</span>)))</span><br><span class="line">    <span class="comment"># browser.refresh()</span></span><br><span class="line">    html = browser.page_source</span><br><span class="line">    <span class="comment"># print(html)</span></span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">    save_to_excel(soup)</span><br></pre></td></tr></table></figure>
<p>5.最后，保存爬取到的结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_to_excel</span>(<span class="params">soup</span>):</span></span><br><span class="line">    list = soup.find(class_=<span class="string">&#x27;video-list clearfix&#x27;</span>).find_all_next(class_=<span class="string">&#x27;info&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> list:</span><br><span class="line">        item_title = item.find(<span class="string">&#x27;a&#x27;</span>).get(<span class="string">&#x27;title&#x27;</span>)</span><br><span class="line">        item_link = item.find(<span class="string">&#x27;a&#x27;</span>).get(<span class="string">&#x27;href&#x27;</span>)</span><br><span class="line">        item_dec = item.find(class_=<span class="string">&#x27;des hide&#x27;</span>).text</span><br><span class="line">        item_view = item.find(class_=<span class="string">&#x27;so-icon watch-num&#x27;</span>).text</span><br><span class="line">        item_biubiu = item.find(class_=<span class="string">&#x27;so-icon hide&#x27;</span>).text</span><br><span class="line">        item_date = item.find(class_=<span class="string">&#x27;so-icon time&#x27;</span>).text</span><br><span class="line"></span><br><span class="line">        print(<span class="string">&#x27;爬取：&#x27;</span> + item_title)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">global</span> n</span><br><span class="line"></span><br><span class="line">        sheet.write(n, <span class="number">0</span>, item_title)</span><br><span class="line">        sheet.write(n, <span class="number">1</span>, item_link)</span><br><span class="line">        sheet.write(n, <span class="number">2</span>, item_dec)</span><br><span class="line">        sheet.write(n, <span class="number">3</span>, item_view)</span><br><span class="line">        sheet.write(n, <span class="number">4</span>, item_biubiu)</span><br><span class="line">        sheet.write(n, <span class="number">5</span>, item_date)</span><br><span class="line"></span><br><span class="line">        n = n + <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>提取到名为视频信息节点名为video-list clearfix的class节点的所有下一级名为info的class节点信息后，在提取各个信息存入excel<br>6.完整代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> TimeoutException</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">browser = webdriver.Chrome()</span><br><span class="line"><span class="comment">#browser = webdriver.PhantomJS()</span></span><br><span class="line">WAIT = WebDriverWait(browser, <span class="number">20</span>)</span><br><span class="line">browser.set_window_size(<span class="number">1400</span>, <span class="number">900</span>)</span><br><span class="line"></span><br><span class="line">book = xlwt.Workbook(encoding=<span class="string">&#x27;utf-8&#x27;</span>, style_compression=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">sheet = book.add_sheet(<span class="string">&#x27;蔡徐坤篮球&#x27;</span>, cell_overwrite_ok=<span class="literal">True</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;名称&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">1</span>, <span class="string">&#x27;地址&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">2</span>, <span class="string">&#x27;描述&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">3</span>, <span class="string">&#x27;观看次数&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">4</span>, <span class="string">&#x27;弹幕数&#x27;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">5</span>, <span class="string">&#x27;发布时间&#x27;</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        print(<span class="string">&#x27;开始访问b站....&#x27;</span>)</span><br><span class="line">        browser.get(<span class="string">&quot;https://www.bilibili.com/&quot;</span>)</span><br><span class="line"></span><br><span class="line">        search = browser.find_element_by_xpath(<span class="string">&#x27;//div[@class=&quot;nav-search&quot;]/form/input&#x27;</span>)</span><br><span class="line">        search.send_keys(<span class="string">&quot;蔡徐坤 篮球&quot;</span>)</span><br><span class="line">        search.send_keys(Keys.ENTER)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 跳转到新的窗口</span></span><br><span class="line">        print(<span class="string">&#x27;跳转到新窗口&#x27;</span>)</span><br><span class="line">        all_h = browser.window_handles</span><br><span class="line">        browser.switch_to.window(all_h[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        html = browser.page_source</span><br><span class="line">        <span class="comment"># print(html)</span></span><br><span class="line">        soup = BeautifulSoup(html, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">        save_to_excel(soup)</span><br><span class="line"></span><br><span class="line">        total_index = soup.find(class_=<span class="string">&#x27;page-item last&#x27;</span>).find(class_=<span class="string">&#x27;pagination-btn&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> int(total_index.text)</span><br><span class="line">    <span class="keyword">except</span> TimeoutException:</span><br><span class="line">        <span class="keyword">return</span> search()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next_page</span>(<span class="params">page_num</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        print(<span class="string">&#x27;获取第(%d)页数据&#x27;</span> % page_num)</span><br><span class="line">        next_btn = WAIT.until(EC.element_to_be_clickable((By.CSS_SELECTOR,</span><br><span class="line">                                                          <span class="string">&#x27;li.page-item.next &gt; button&#x27;</span>)))</span><br><span class="line">        <span class="comment"># time.sleep(5)</span></span><br><span class="line">        next_btn.click()</span><br><span class="line">        get_source()</span><br><span class="line">    <span class="keyword">except</span> TimeoutException:</span><br><span class="line">        browser.refresh()</span><br><span class="line">        <span class="keyword">return</span> next_page(page_num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_to_excel</span>(<span class="params">soup</span>):</span></span><br><span class="line">    list = soup.find(class_=<span class="string">&#x27;video-list clearfix&#x27;</span>).find_all_next(class_=<span class="string">&#x27;info&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> list:</span><br><span class="line">        item_title = item.find(<span class="string">&#x27;a&#x27;</span>).get(<span class="string">&#x27;title&#x27;</span>)</span><br><span class="line">        item_link = item.find(<span class="string">&#x27;a&#x27;</span>).get(<span class="string">&#x27;href&#x27;</span>)</span><br><span class="line">        item_dec = item.find(class_=<span class="string">&#x27;des hide&#x27;</span>).text</span><br><span class="line">        item_view = item.find(class_=<span class="string">&#x27;so-icon watch-num&#x27;</span>).text</span><br><span class="line">        item_biubiu = item.find(class_=<span class="string">&#x27;so-icon hide&#x27;</span>).text</span><br><span class="line">        item_date = item.find(class_=<span class="string">&#x27;so-icon time&#x27;</span>).text</span><br><span class="line"></span><br><span class="line">        print(<span class="string">&#x27;爬取：&#x27;</span> + item_title)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">global</span> n</span><br><span class="line"></span><br><span class="line">        sheet.write(n, <span class="number">0</span>, item_title)</span><br><span class="line">        sheet.write(n, <span class="number">1</span>, item_link)</span><br><span class="line">        sheet.write(n, <span class="number">2</span>, item_dec)</span><br><span class="line">        sheet.write(n, <span class="number">3</span>, item_view)</span><br><span class="line">        sheet.write(n, <span class="number">4</span>, item_biubiu)</span><br><span class="line">        sheet.write(n, <span class="number">5</span>, item_date)</span><br><span class="line"></span><br><span class="line">        n = n + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_source</span>():</span></span><br><span class="line">    WAIT.until(EC.presence_of_element_located(</span><br><span class="line">        (By.CSS_SELECTOR, <span class="string">&#x27;ul.video-list.clearfix&#x27;</span>)))</span><br><span class="line">    <span class="comment"># browser.refresh()</span></span><br><span class="line">    html = browser.page_source</span><br><span class="line">    <span class="comment"># print(html)</span></span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">    save_to_excel(soup)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        total = search()</span><br><span class="line">        <span class="comment"># print(total)</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, int(total)+<span class="number">1</span>):</span><br><span class="line">            next_page(i)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        browser.close()</span><br><span class="line">        browser.quit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line">    book.save(<span class="string">u&#x27;蔡徐坤篮球.xls&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>最后将excel文档保存为xls格式，在有的电脑上面保存为xlsx格式时，本地打开文档出现格式错误的问题，将保存格式更改为xls可以解决该问题。</p>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/python3-%E7%88%AC%E8%99%AB/">python3 爬虫</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-python pyqt5开发小结" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/07/24/python%20pyqt5%E5%BC%80%E5%8F%91%E5%B0%8F%E7%BB%93/" class="article-date">
      <time datetime="2020-07-24T10:36:50.000Z" itemprop="datePublished">2020-07-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/24/python%20pyqt5%E5%BC%80%E5%8F%91%E5%B0%8F%E7%BB%93/">python pyqt5开发小结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>最近几天用python+pyqt5+QtDesigner编写了两个小软件，在这里做一个简单的总结。<br>1.创建新控件时需要指定父控件<br>2.可以在状态栏上添加额外的文本提示或者进度条显示</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">frame2_bar = QStatusBar()</span><br><span class="line">self.sr_lable = QLabel(self.rom_frame)</span><br><span class="line">   self.sr_lable.setText(<span class="string">&#x27;S:       R:      &#x27;</span>)</span><br><span class="line">  elf.sr_lable.setGeometry(<span class="number">100</span>, frame.height(), <span class="number">50</span>, <span class="number">25</span>)</span><br><span class="line">  frame2_bar.addPermanentWidget(self.sr_lable)</span><br></pre></td></tr></table></figure>
<p>3.是TextEdit文本填满文本框后。自动向下滚屏</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">self.textEdit.moveCursor(QTextCursor.End)</span><br><span class="line">   self.textEdit.insertPlainText(out_s)</span><br></pre></td></tr></table></figure>

<p>4.通过事件弹出自动义新窗口</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Form implementation generated from reading ui file &#x27;time_display.ui&#x27;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Created by: PyQt5 UI code generator 5.15.0</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># WARNING: Any manual changes made to this file will be lost when pyuic5 is</span></span><br><span class="line"><span class="comment"># run again.  Do not edit this file unless you know what you are doing.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PyQt5 <span class="keyword">import</span> QtCore, QtGui, QtWidgets</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ui_Dialog</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setupUi</span>(<span class="params">self, Dialog</span>):</span></span><br><span class="line">        Dialog.setObjectName(<span class="string">&quot;Dialog&quot;</span>)</span><br><span class="line">        Dialog.resize(<span class="number">280</span>, <span class="number">198</span>)</span><br><span class="line">        self.widget = QtWidgets.QWidget(Dialog)</span><br><span class="line">        self.widget.setGeometry(QtCore.QRect(<span class="number">50</span>, <span class="number">20</span>, <span class="number">191</span>, <span class="number">151</span>))</span><br><span class="line">        self.widget.setObjectName(<span class="string">&quot;widget&quot;</span>)</span><br><span class="line">        self.verticalLayout = QtWidgets.QVBoxLayout(self.widget)</span><br><span class="line">        self.verticalLayout.setContentsMargins(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        self.verticalLayout.setObjectName(<span class="string">&quot;verticalLayout&quot;</span>)</span><br><span class="line">        self.label_2 = QtWidgets.QLabel(self.widget)</span><br><span class="line">        font = QtGui.QFont()</span><br><span class="line">        font.setPointSize(<span class="number">20</span>)</span><br><span class="line">        self.label_2.setFont(font)</span><br><span class="line">        self.label_2.setObjectName(<span class="string">&quot;label_2&quot;</span>)</span><br><span class="line">        self.verticalLayout.addWidget(self.label_2)</span><br><span class="line">        self.label = QtWidgets.QLabel(self.widget)</span><br><span class="line">        font = QtGui.QFont()</span><br><span class="line">        font.setPointSize(<span class="number">20</span>)</span><br><span class="line">        self.label.setFont(font)</span><br><span class="line">        self.label.setAlignment(QtCore.Qt.AlignCenter)</span><br><span class="line">        self.label.setObjectName(<span class="string">&quot;label&quot;</span>)</span><br><span class="line">        self.verticalLayout.addWidget(self.label)</span><br><span class="line">        self.pushButton = QtWidgets.QPushButton(self.widget)</span><br><span class="line">        self.pushButton.setObjectName(<span class="string">&quot;pushButton&quot;</span>)</span><br><span class="line">        self.verticalLayout.addWidget(self.pushButton)</span><br><span class="line"></span><br><span class="line">        self.retranslateUi(Dialog)</span><br><span class="line">        QtCore.QMetaObject.connectSlotsByName(Dialog)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">retranslateUi</span>(<span class="params">self, Dialog</span>):</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ex_pygui.time_display <span class="keyword">import</span> Ui_Dialog  <span class="comment"># 显示自定义的弹出窗口</span></span><br><span class="line">        self.di = QDialog()</span><br><span class="line">        timedisplay = Ui_Dialog()</span><br><span class="line">        timedisplay.setupUi(self.di)</span><br><span class="line">        now = time.localtime()</span><br><span class="line">        timedisplay.label.setText(<span class="string">&#x27;%02d:%02d:%02d&#x27;</span> %(now.tm_hour, now.tm_min, now.tm_sec))</span><br><span class="line">        timedisplay.pushButton.clicked.connect(self.di.close)</span><br><span class="line">        self.di.setWindowModality(Qt.ApplicationModal) <span class="comment">#锁定子窗口，关闭子窗口后才可以操作父窗口</span></span><br><span class="line"></span><br><span class="line">        self.di.show()</span><br></pre></td></tr></table></figure>
<p>可以先创建一个QDialog窗口，然后在外部调用，如上代码所示<br>5.保存Excel文件为xlsx格式报错，可以将文件保存为xls格式<br>6.sqlite数据库确实简便好用<br>7.python的线程开启后，在死循环内会一直运行，无法暂停和关闭，需要重新编写定义</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ser_recvthread</span>(<span class="params">threading.Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, func</span>):</span></span><br><span class="line">        super(ser_recvthread, self).__init__()</span><br><span class="line">        self.func = func</span><br><span class="line">        self.__flag = threading.Event()  <span class="comment"># 用于暂停线程的标识</span></span><br><span class="line">        self.__flag.set()  <span class="comment"># 设置为True</span></span><br><span class="line">        self.__running = threading.Event()  <span class="comment"># 用于停止线程的标识</span></span><br><span class="line">        self.__running.set()  <span class="comment"># 将running设置为True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">while</span> self.__running.isSet():</span><br><span class="line">            self.__flag.wait()  <span class="comment"># 为True时立即返回, 为False时阻塞直到内部的标识位为True后返回</span></span><br><span class="line">            self.func()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pause</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__flag.clear()  <span class="comment"># 设置为False, 让线程阻塞</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">resume</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__flag.set()  <span class="comment"># 设置为True, 让线程停止阻塞</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">stop</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.__flag.clear()</span><br><span class="line">        self.__running.clear()  <span class="comment"># 设置为False</span></span><br><span class="line"></span><br><span class="line">self.ser_thread = ser_recvthread(self.ser_recv)</span><br><span class="line">self.ser_thread.start()</span><br><span class="line">self.ser_thread.pause()</span><br><span class="line">self.ser_thread.resume()</span><br></pre></td></tr></table></figure>
<p>8.pyserial获取串口列表，并添加到combox中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> serial.tools.list_ports</span><br><span class="line">self.ser_num.clear()</span><br><span class="line">   plist = list(serial.tools.list_ports.comports())</span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(plist)):</span><br><span class="line">       plist_0 = list(plist[i])</span><br><span class="line">       <span class="comment">#print(&#x27;串口号：&#x27;, list(plist[i]),str(plist_0[0]))</span></span><br><span class="line">       self.ser_num.addItem(plist_0[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<p>9.在这次写代码的过程中，我通过线程读取串口数据时，在数据量比较小，且发送数据比较慢的情况下，串口接收还比较正常，但是在数据量比较大且传输速度比较快时会出现卡死的情况，换成定时器定时1ms读取就没问题；不知道是线程部分的逻辑有问题还是怎么回事，暂时还没弄明白，暂且搁置，哪位大神如果看到这，有相关解决办法，欢迎指正。所以暂且推荐读取串口数据时采用定时读取的方式。</p>
<p>暂时就写到这，后续想到有必要记录的再继续添加。</p>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/GUI/">GUI</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-获取程序编译后链接脚本中变量" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/12/19/%E8%8E%B7%E5%8F%96%E7%A8%8B%E5%BA%8F%E7%BC%96%E8%AF%91%E5%90%8E%E9%93%BE%E6%8E%A5%E8%84%9A%E6%9C%AC%E4%B8%AD%E5%8F%98%E9%87%8F/" class="article-date">
      <time datetime="2019-12-19T09:11:39.000Z" itemprop="datePublished">2019-12-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/19/%E8%8E%B7%E5%8F%96%E7%A8%8B%E5%BA%8F%E7%BC%96%E8%AF%91%E5%90%8E%E9%93%BE%E6%8E%A5%E8%84%9A%E6%9C%AC%E4%B8%AD%E5%8F%98%E9%87%8F/">获取程序编译后链接脚本中变量</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>sct文件：各段在内存中的分配情况，每一次编译完后</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> Image$$ER_IROM1$$Base;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> Image$$ER_IROM1$$Limit;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> Image$$ER_IROM1$$Length;   </span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> Image$$RW_IRAM1$$Base;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> Image$$RW_IRAM1$$Limit;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> Image$$RW_IRAM1$$Length;     </span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> Image$$RW_IRAM1$$ZI$$Base;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> Image$$RW_IRAM1$$ZI$$Limit;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> Image$$RW_IRAM1$$ZI$$Length;    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> base,limit,length;</span><br><span class="line">base = (<span class="keyword">unsigned</span> <span class="keyword">int</span> )&amp;Image$$ER_IROM1$$Base;</span><br><span class="line">limit = (<span class="keyword">unsigned</span> <span class="keyword">int</span> )&amp;Image$$ER_IROM1$$Limit;</span><br><span class="line">length = (<span class="keyword">unsigned</span> <span class="keyword">int</span> )&amp;Image$$ER_IROM1$$Length;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nER_IROM1 Base = 0x%x\nER_IROM1 Limit = 0x%x\nER_IROM1 Length = %d\n&quot;</span>,base,limit,length);</span><br><span class="line"></span><br><span class="line">base = (<span class="keyword">unsigned</span> <span class="keyword">int</span> )&amp;Image$$RW_IRAM1$$Base;</span><br><span class="line">limit = (<span class="keyword">unsigned</span> <span class="keyword">int</span> )&amp;Image$$RW_IRAM1$$Limit;</span><br><span class="line">length = (<span class="keyword">unsigned</span> <span class="keyword">int</span> )&amp;Image$$RW_IRAM1$$Length;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nRW_IRAM1 Base = 0x%x\nRW_IRAM1 Limit = 0x%x\nRW_IRAM1 Length = %d\n&quot;</span>,base,limit,length);</span><br><span class="line"></span><br><span class="line">base = (<span class="keyword">unsigned</span> <span class="keyword">int</span> )&amp;Image$$RW_IRAM1$$ZI$$Base;</span><br><span class="line">limit = (<span class="keyword">unsigned</span> <span class="keyword">int</span> )&amp;Image$$RW_IRAM1$$ZI$$Limit;</span><br><span class="line">length = (<span class="keyword">unsigned</span> <span class="keyword">int</span> )&amp;Image$$RW_IRAM1$$ZI$$Length;  </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nRW_IRAM1_ZI Base = 0x%x\nRW_IRAM1_ZI Limit = 0x%x\nRW_IRAM1_ZI Length = %d\n&quot;</span>,base,limit,length);</span><br></pre></td></tr></table></figure>

<pre><code>Image$$ER_IROM1$$Length : CODE段和RO_data段的大小
Image$$RW_IRAM1$$Length : RW_data段的大小
Image$$RW_IRAM1$$ZI$$Length : ZI_data段的大小</code></pre>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/%E9%A9%B1%E5%8A%A8/">驱动</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Ubuntu启动报错error_unknown filesystem解决方案" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/08/08/Ubuntu%E5%90%AF%E5%8A%A8%E6%8A%A5%E9%94%99error_unknown%20filesystem%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" class="article-date">
      <time datetime="2019-08-08T07:42:29.000Z" itemprop="datePublished">2019-08-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/08/Ubuntu%E5%90%AF%E5%8A%A8%E6%8A%A5%E9%94%99error_unknown%20filesystem%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">项目调试一点小结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>我安装的时ubuntu14.04，长时间没启用，最近准备进入Ubuntu系统的时候就出现报错<br>unknown filesystem<br>grub rescue&gt;<br>解决方案<br>1.如果不知道自己安装的ununtu系统启动文件再那个分区，可以先查找分区<br>grub rescue&gt; ls<br>执行该命令后<br>就会出现电脑上类似如下的所有的分区列表<br>(hd0),(hd0,gpt0)…<br>2.接下来查找查找具体的Ubuntu系统所在分区<br>grub rescue&gt;ls (hd0,gpt0)<br>这样就可以每个分区的相关信息，遍历所有的分区查找到Ubuntu所在分区<br>如果Ubuntu不再该分区，就还是会出现unknown filesystem的提示<br>3.修改启动分区<br>找到ubuntu所在分区后<br>执行如下指令：<br>grub rescue&gt;set root=(hs0,gpt10)(我的Ubuntu分区实在第10个分区)<br>grub rescue&gt;set prefix=(hd0,gpt10)/boot/grub<br>grub rescue&gt;insmod normal<br>grub rescue&gt;normal<br>依次执行后就可以正常启动ubuntu系统了<br>4.修复grub<br>正常启动ubuntu后，启动命令行<br>执行如下指令<br>sudo update-rub<br>sudo grub-install/dev/sda(重建grub到第一硬盘mbr)<br>到这该问题就解决了。</p>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Nordic/">Nordic</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-项目调试一点小结" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/08/08/%E9%A1%B9%E7%9B%AE%E8%B0%83%E8%AF%95%E4%B8%80%E7%82%B9%E5%B0%8F%E7%BB%93/" class="article-date">
      <time datetime="2019-08-08T07:42:29.000Z" itemprop="datePublished">2019-08-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/08/%E9%A1%B9%E7%9B%AE%E8%B0%83%E8%AF%95%E4%B8%80%E7%82%B9%E5%B0%8F%E7%BB%93/">项目调试一点小结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>  最近调试nordic项目时，遇到一个奇怪的问题，在将bootloader和应用程序烧录到板子上后，出现程序跑不起来的情况。<br>  在Nordic上有两个引脚默认是作为NFCT的天线引脚来用的，因为项目需要，这两个引脚需要作为GPIO引脚来用，因此需要配置寄存器来使能这两个引脚的GPIO功能。<img src="https://img-blog.csdnimg.cn/20190808144836552.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzMzMzIzNTQ0,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>  <img src="https://img-blog.csdnimg.cn/20190808150916997.png" alt="在这里插入图片描述"><br>  在项目上硬件设计上，通过引脚控制一个MOS管来控制，电路电源VDD的打开和关闭，同时VDD和一个10uF电容串联接地。<br>  在没有配置NFCT两个引脚为GPIO之前，我们做了如下一些测试，首先利用示波器查看MOS管输出脚的电平，发现在MOS管开通情况下，输出脚电平只有2.6V左右，比理想的3.3V低，同时测试MOS管的控制脚电平，控制脚电平电压大概有0.9V.比正常的0V略高；出现这种情况是由于，NFCT两个引脚没有配置为GPIO脚，这两个引脚处于悬浮状态，无法输出准确的电平。<br>  在配置两个引脚为GPIO引脚后，出现板子无法正常运行的情况，这时我们在继续上述测试，发现有时候改变MOS管控制脚的电平的时候，对应的VDD电平只是瞬间变化一下，然后又会恢复到改变MOS管控制脚电平之前的状态，这就会导致其他器件IC无法正常工作；这是再测试芯片供电电平，改变MOS管控制脚电平，在示波器上发现芯片供电的电平状态会出现瞬间变为低电平的然后又变成高电平的情况；可以确定芯片在改变MOS管控制脚电平的时候出现了复位。所以就导致板子出现一直复位的情况，无法正常运行的情况。再看硬件电路，会发现在打开VDD电源的瞬间，由于VDD和电容串联，在电容的作用下，会出现很大的冲激电流，导致芯片供电的LDO进入保护状态导致复位。<br>  解决方法：板子上的i2c之前已经外接上拉电阻和VDD相连，所以在打开VDD电源之前可以先配置i2c的两个引脚为高电平，并延时一段时间，给vdd端的电容足够时间充电，来防止在打开MOS管的时候产生很大的冲激电流，导致复位。在打开电源以后，再把i2c两引脚配置为输入。</p>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Nordic/">Nordic</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-提升刷屏速度，降低显示水纹效果的一点想法" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/08/08/%E6%8F%90%E5%8D%87%E5%88%B7%E5%B1%8F%E9%80%9F%E5%BA%A6%EF%BC%8C%E9%99%8D%E4%BD%8E%E6%98%BE%E7%A4%BA%E6%B0%B4%E7%BA%B9%E6%95%88%E6%9E%9C%E7%9A%84%E4%B8%80%E7%82%B9%E6%83%B3%E6%B3%95/" class="article-date">
      <time datetime="2019-08-08T06:16:58.000Z" itemprop="datePublished">2019-08-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/08/%E6%8F%90%E5%8D%87%E5%88%B7%E5%B1%8F%E9%80%9F%E5%BA%A6%EF%BC%8C%E9%99%8D%E4%BD%8E%E6%98%BE%E7%A4%BA%E6%B0%B4%E7%BA%B9%E6%95%88%E6%9E%9C%E7%9A%84%E4%B8%80%E7%82%B9%E6%83%B3%E6%B3%95/">提升刷屏速度，降低显示水纹效果的一点想法</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>一般再nordic上画图都是采用emwin库函数画图，但是这样都比较慢，因为库函数都是每次读取图片的一行数据写入屏中显示，画图过程中水纹比较明显，所以之前自己从flash中读取图片数据，不采用库函数，自己读取显示可以一次从flash中，读取超过一行的数据，这样可以明显的，提升刷屏效果，但是当图片数据比较大，刷屏的频次比较快时，也会有水纹效果，所以还是有点不如人意。<br>所以这里我想，是不是可以在flash中划分一块整屏大小的区域，用来存储一整屏大小的数据，当那些图片比较大，刷屏频次快的界面时，可以先将这一整屏的数据写入到flash中划分的区域，然后再将falsh中的数据读取出来写入到屏幕中显示；相比之前，这样的话每次只需要刷一整屏的数据就可以完成显示，相当于在flash中写入一张整屏大小图片的数据，然后将这张图片的数据读取出来显示，按我之前的自己从flash中读取数据显示的方法，在240*240的屏幕上，刷一整屏的数据大概需要200ms，速度应该算是比较快的，但是在显示指针表盘时，特别是在显示秒针的情况下，由于视觉暂留效果，还是会有轻微的刷屏水纹效果。<br>或许还可以更进一步，将屏幕划分为四块区域，每块区域在flash对应的有一块存储空间，当屏幕上的显示部分需要改动的不太大时，比如只是文字，这样就可以直接显示在屏幕上；如果要改动秒针，或者要刷新的某一部分短时间内要多次刷新，就只需要改动这四块区域中的某一块，或者两块，这样的话，需要刷新的部分就显著减少了，刷屏是的效果也会比较好。</p>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/GUI/">GUI</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-4412学习笔记" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/07/05/4412%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="article-date">
      <time datetime="2019-07-05T11:33:54.000Z" itemprop="datePublished">2019-07-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/05/4412%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">4412学习笔记</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>局域网通信：<br>同一网段：当一个网路的IP地址与子网掩码相与之后的值与另一个网络的IP地址与子网掩码相与值后的值相等的时候，就可以认为两个网络处于同一网段，这时两个网络就可以通过网络进行通信。确认两个网络是否可以通信，可以使用ping指令（ping + ip）。<br>    假如现在有两个网络设备，可以将两个网络设备直接利用网线连接在一起或者利用路由器，两个网络设备接在同一个路由器上，然后在其中一个网络设备上使用<strong>ping + 另一设备的网络地址</strong>，如果可以ping通，就表示两个网络再同一网段，可以正常通信；如果ping不通，可以手动修改两个网络设备的ip地址，使得这两个网络处于同一网段，就可以建立简单的局域网通信了。</p>

      
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Linux/">Linux</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2020 xianke5200
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
        </div>
        
			<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
			<script>
				var now = new Date(); 
				function createtime() { 
					var grt= new Date("10/14/2020 22:15:00");//在此处修改你的建站时间，格式：月/日/年 时:分:秒
					now.setTime(now.getTime()+250); 
					days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
					hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
					if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
					mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
					seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
					snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
					document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
					document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
				} 
			setInterval("createtime()",250);
			</script>
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >网页到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</footer>

    </div>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>


<script src="/js/main.js"></script>


    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


    <script type="text/javascript">
      window.onload = function(){
        document.getElementById("search").onclick = function(){
            console.log("search")
            search();
        }
      }
      function search(){
        (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
        (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
        e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
        })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

        _st('install','A1Pz-LKMXbrzcFg2FWi6','2.0.0');
      }
    </script>

  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>

<!--动态线条背景-->
<script type="text/javascript"
color="220,220,220" opacity='0.7' zIndex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
</script>

<!--单击显示文字-->
<script type="text/javascript" src="/js/click_show_text.js"></script>

<!--单击爆炸效果-->
<canvas %#class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" %#></canvas> 
<script %#type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"%#></script> 
<script %#type="text/javascript" src="/js/fireworks.js"%#></script>

<!--单击烟花效果-->
<canvas width="1777" height="841" style="position: fixed; left: 0px; top: 0px; z-index: 999; pointer-events: none;"></canvas>
<script type="text/javascript" src="/js/mouse_fire.js"></script>